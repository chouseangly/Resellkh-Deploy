# This file tells Google Cloud Build how to build and push your Docker image.
steps:
  # The first and only step is to run the 'docker build' command.
- name: 'gcr.io/cloud-builders/docker'
  args:
    # 'build' is the docker command
    - 'build'

    # '--tag' gives the image a name.
    - '--tag'
    - 'gcr.io/$PROJECT_ID/resellkh-deploy'

    # '--build-arg' is the special instruction to pass your URL to the Dockerfile.
    # This is the line that fixes your error.
    - '--build-arg'
    - 'NEXTAUTH_URL=https://resellkh-deploy-1063848356446.europe-west1.run.app'

    # '.' tells docker to find the Dockerfile in the current directory.
    - '.'

# This tells Cloud Build to push the final image to the Google Container Registry.
images:
- 'gcr.io/$PROJECT_ID/resellkh-deploy'